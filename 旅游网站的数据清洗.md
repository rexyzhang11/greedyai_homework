```python
import numpy as np
import pandas as pd
```


```python
df = pd.read_csv("qunar_freetrip.csv",index_col=0)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>哈尔滨</td>
      <td>北海</td>
      <td>2208.0</td>
      <td>650.0</td>
      <td>哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票</td>
      <td>北海祥丰嘉年华大酒店 舒适型 4.7分/5分</td>
      <td>标准双人间(双床) 双床 不含早 1间2晚</td>
      <td>春秋航空 9C8741</td>
      <td>直飞</td>
      <td>17:10-21:50</td>
      <td>春秋航空 9C8742</td>
      <td>直飞</td>
      <td>10:20-15:05</td>
    </tr>
    <tr>
      <td>1</td>
      <td>成都</td>
      <td>泸沽湖</td>
      <td>1145.0</td>
      <td>376.0</td>
      <td>成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票</td>
      <td>7天酒店丽江古城中心店 经济型 4.0分/5分</td>
      <td>经济房-不含早-限时特... 其他 不含早 1间2晚</td>
      <td>成都航空 EU2237</td>
      <td>直飞</td>
      <td>19:45-21:20</td>
      <td>成都航空 EU2738</td>
      <td>直飞</td>
      <td>23:30-01:05</td>
    </tr>
    <tr>
      <td>2</td>
      <td>广州</td>
      <td>沈阳</td>
      <td>2702.0</td>
      <td>618.0</td>
      <td>广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票</td>
      <td>沈阳中煤宾馆 舒适型 4.5分/5分</td>
      <td>大床间(内宾) 大床 双早 1间2晚</td>
      <td>南方航空 CZ6384</td>
      <td>直飞</td>
      <td>08:05-11:45</td>
      <td>深圳航空 ZH9652</td>
      <td>经停</td>
      <td>08:20-13:05</td>
    </tr>
    <tr>
      <td>3</td>
      <td>上海</td>
      <td>九寨沟</td>
      <td>1954.0</td>
      <td>484.0</td>
      <td>上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票</td>
      <td>红原芸谊大酒店 舒适型 4.6分/5分</td>
      <td>豪华双床房[双早] 双床 双早 1间2晚</td>
      <td>成都航空 EU6678</td>
      <td>直飞</td>
      <td>21:55-01:15</td>
      <td>成都航空 EU6677</td>
      <td>直飞</td>
      <td>17:45-20:35</td>
    </tr>
    <tr>
      <td>4</td>
      <td>广州</td>
      <td>天津</td>
      <td>1608.0</td>
      <td>422.0</td>
      <td>广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票</td>
      <td>天津逸海明珠大酒店 高档型 4.1分/5分</td>
      <td>豪华双床房(预付) 双床 不含早 1间2晚</td>
      <td>奥凯航空 BK2787</td>
      <td>直飞</td>
      <td>06:55-10:00</td>
      <td>海南航空 HU7201</td>
      <td>直飞</td>
      <td>20:15-23:25</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>5095</td>
      <td>宁波</td>
      <td>九寨沟</td>
      <td>2085.0</td>
      <td>562.0</td>
      <td>宁波-九寨沟3天2晚 | 入住黑水县达古冰山国际大酒店 + 成都航空/四川航空往...</td>
      <td>黑水县达古冰山国际大酒店 豪华型 3.9分/5分</td>
      <td>B区豪华标间(双床) 双床 不含早 1间2晚</td>
      <td>成都航空 EU2730</td>
      <td>经停</td>
      <td>19:45-00:45</td>
      <td>四川航空 3U8927</td>
      <td>经停</td>
      <td>07:55-12:15</td>
    </tr>
    <tr>
      <td>5096</td>
      <td>成都</td>
      <td>泸沽湖</td>
      <td>1158.0</td>
      <td>376.0</td>
      <td>成都-泸沽湖3天2晚 | 入住丽江望月阁客栈 + 成都航空往返机票</td>
      <td>丽江望月阁客栈 经济型 4.6分/5分</td>
      <td>标准双人间-不含早（预... 双床 不含早 1间2晚</td>
      <td>成都航空 EU2237</td>
      <td>直飞</td>
      <td>19:45-21:20</td>
      <td>成都航空 EU2738</td>
      <td>直飞</td>
      <td>23:30-01:05</td>
    </tr>
    <tr>
      <td>5097</td>
      <td>天津</td>
      <td>丽江</td>
      <td>1616.0</td>
      <td>426.0</td>
      <td>天津-丽江3天2晚 | 入住丽江凡间度假连锁客栈青旅店 + 天津航空/首都航空往...</td>
      <td>丽江凡间度假连锁客栈青旅店 经济型 4.5分/5分</td>
      <td>大床房-预付 大床 不含早 1间2晚</td>
      <td>天津航空 GS7861</td>
      <td>直飞</td>
      <td>16:25-19:45</td>
      <td>首都航空 JD5739</td>
      <td>直飞</td>
      <td>07:50-10:50</td>
    </tr>
    <tr>
      <td>5098</td>
      <td>大连</td>
      <td>重庆</td>
      <td>1703.0</td>
      <td>446.0</td>
      <td>大连-重庆3天2晚 | 入住重庆酉阳锦宏大酒店 + 华夏航空/山东航空往返机票</td>
      <td>重庆酉阳锦宏大酒店 舒适型 4.0分/5分</td>
      <td>特惠房(大床) 大床 不含早 1间2晚</td>
      <td>华夏航空 G52762</td>
      <td>经停</td>
      <td>18:25-23:30</td>
      <td>山东航空 SC4837</td>
      <td>经停</td>
      <td>07:00-11:30</td>
    </tr>
    <tr>
      <td>5099</td>
      <td>天津</td>
      <td>哈尔滨</td>
      <td>1192.0</td>
      <td>356.0</td>
      <td>天津-哈尔滨3天2晚 | 入住哈尔滨钰轩酒店中央大街店 + 奥凯航空/福州往返机票</td>
      <td>哈尔滨钰轩酒店中央大街店 舒适型 4.0分/5分</td>
      <td>标准大床房 大床 大床 双早 1间2晚</td>
      <td>奥凯航空 BK2918</td>
      <td>直飞</td>
      <td>21:10-23:25</td>
      <td>福州 FU6556</td>
      <td>直飞</td>
      <td>11:35-13:45</td>
    </tr>
  </tbody>
</table>
<p>5100 rows × 13 columns</p>
</div>




```python
df.dtypes
```




    出发地       object
     目的地      object
    价格       float64
    节省       float64
    路线名       object
    酒店        object
    房间        object
    去程航司      object
    去程方式      object
    去程时间      object
    回程航司      object
    回程方式      object
    回程时间      object
    dtype: object




```python
df.columns[0]
```




    '出发地 '




```python
df.columns.values[0].strip() #.strip()去除空格
```




    '出发地'




```python
df.shape
```




    (5100, 13)




```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 5100 entries, 0 to 5099
    Data columns (total 13 columns):
    出发地      5098 non-null object
     目的地     5099 non-null object
    价格       5072 non-null float64
    节省       5083 non-null float64
    路线名      5100 non-null object
    酒店       5100 non-null object
    房间       5100 non-null object
    去程航司     5100 non-null object
    去程方式     5100 non-null object
    去程时间     5100 non-null object
    回程航司     5100 non-null object
    回程方式     5100 non-null object
    回程时间     5100 non-null object
    dtypes: float64(2), object(11)
    memory usage: 557.8+ KB
    


```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>价格</th>
      <th>节省</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>5072.000000</td>
      <td>5083.000000</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>1765.714905</td>
      <td>474.139878</td>
    </tr>
    <tr>
      <td>std</td>
      <td>2580.129644</td>
      <td>168.893780</td>
    </tr>
    <tr>
      <td>min</td>
      <td>578.000000</td>
      <td>306.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>1253.000000</td>
      <td>358.000000</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>1632.000000</td>
      <td>436.000000</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>2028.250000</td>
      <td>530.000000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>179500.000000</td>
      <td>3500.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.columns
```




    Index(['出发地 ', ' 目的地', '价格 ', '节省', '路线名', '酒店', '房间', '去程航司', '去程方式', '去程时间',
           '回程航司', '回程方式 ', '回程时间'],
          dtype='object')




```python
col = df.columns.values
```


```python
col[0].strip()
```




    '出发地'




```python
df.columns = [x.strip() for x in col]
```


```python
df.columns.values
```




    array(['出发地', '目的地', '价格', '节省', '路线名', '酒店', '房间', '去程航司', '去程方式',
           '去程时间', '回程航司', '回程方式', '回程时间'], dtype=object)



### 重复值的处理
- duplicated() 显示重复值，返回的是一个布尔的数据类型
- drop_duplicates() :删除重复值


```python
df.duplicated() #显示为True的地方表示和前面的数据重复了
```




    0       False
    1       False
    2       False
    3       False
    4       False
            ...  
    5095     True
    5096    False
    5097    False
    5098    False
    5099    False
    Length: 5100, dtype: bool




```python
df.duplicated().sum()
```




    100




```python
df[df.duplicated()] #存在两行以上的整行数据重复
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>454</td>
      <td>广州</td>
      <td>黄山</td>
      <td>1871.0</td>
      <td>492.0</td>
      <td>广州-黄山3天2晚 | 入住黄山汤口醉享主题酒店 + 南方航空往返机票</td>
      <td>黄山汤口醉享主题酒店 舒适型 4.8分/5分</td>
      <td>睫毛弯弯(大床) 大床 不含早 1间2晚</td>
      <td>南方航空 CZ3627</td>
      <td>直飞</td>
      <td>19:20-21:15</td>
      <td>南方航空 CZ3628</td>
      <td>直飞</td>
      <td>22:05-23:50</td>
    </tr>
    <tr>
      <td>649</td>
      <td>济南</td>
      <td>长沙</td>
      <td>1134.0</td>
      <td>360.0</td>
      <td>济南-长沙3天2晚 | 入住长沙喜迎宾华天大酒店 + 山东航空往返机票</td>
      <td>长沙喜迎宾华天大酒店 高档型 3.7分/5分</td>
      <td>特惠双间(特惠抢购)(... 双床 不含早 1间2晚</td>
      <td>山东航空 SC1185</td>
      <td>直飞</td>
      <td>18:40-20:50</td>
      <td>山东航空 SC1186</td>
      <td>直飞</td>
      <td>10:20-12:15</td>
    </tr>
    <tr>
      <td>685</td>
      <td>青岛</td>
      <td>重庆</td>
      <td>1474.0</td>
      <td>420.0</td>
      <td>青岛-重庆3天2晚 | 入住怡家丽景酒店重庆垫江店 + 山东航空/华夏航空往返机票</td>
      <td>怡家丽景酒店重庆垫江店 舒适型 4.3分/5分</td>
      <td>法式房(内宾)(无窗)... 大床 不含早 1间2晚</td>
      <td>山东航空 SC4709</td>
      <td>经停</td>
      <td>19:30-00:05</td>
      <td>华夏航空 G54710</td>
      <td>经停</td>
      <td>18:00-22:25</td>
    </tr>
    <tr>
      <td>852</td>
      <td>北京</td>
      <td>哈尔滨</td>
      <td>1450.0</td>
      <td>368.0</td>
      <td>北京-哈尔滨3天2晚 | 入住哈尔滨水逸城市酒店 + 南方航空/大新华航空往返机票</td>
      <td>哈尔滨水逸城市酒店 舒适型 4.6分/5分</td>
      <td>标准间-【预付特惠】独... 双床 双早 1间2晚</td>
      <td>南方航空 CZ6202</td>
      <td>直飞</td>
      <td>22:20-00:20</td>
      <td>大新华航空 CN7150</td>
      <td>直飞</td>
      <td>22:50-00:55</td>
    </tr>
    <tr>
      <td>922</td>
      <td>北京</td>
      <td>长沙</td>
      <td>1289.0</td>
      <td>334.0</td>
      <td>北京-长沙3天2晚 | 入住浏阳市华尔宫大酒店 + 海南航空/南方航空往返机票</td>
      <td>浏阳市华尔宫大酒店 3.8分/5分</td>
      <td>豪华双人间(双床) 双床 不含早 1间2晚</td>
      <td>海南航空 HU7135</td>
      <td>直飞</td>
      <td>17:45-20:30</td>
      <td>南方航空 CZ3855</td>
      <td>直飞</td>
      <td>22:55-01:10</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>5045</td>
      <td>杭州</td>
      <td>丽江</td>
      <td>2872.0</td>
      <td>718.0</td>
      <td>杭州-丽江3天2晚 | 入住丽江松竹居客栈玉观音店 + 长龙航空/首都航空往返机票</td>
      <td>丽江松竹居客栈玉观音店 高档型 4.6分/5分</td>
      <td>特惠房(大床) 大床 不含早 1间2晚</td>
      <td>长龙航空 GJ8869</td>
      <td>经停</td>
      <td>08:50-13:35</td>
      <td>首都航空 JD5192</td>
      <td>直飞</td>
      <td>13:00-16:15</td>
    </tr>
    <tr>
      <td>5066</td>
      <td>哈尔滨</td>
      <td>西安</td>
      <td>1843.0</td>
      <td>450.0</td>
      <td>哈尔滨-西安3天2晚 | 入住西安铁通商务酒店贵宾楼 + 天津航空/东方航空往返...</td>
      <td>西安铁通商务酒店贵宾楼 舒适型 4.2分/5分</td>
      <td>标准间(持房卡尊享清凉... 双床 不含早 1间2晚</td>
      <td>天津航空 GS7584</td>
      <td>经停</td>
      <td>12:30-17:40</td>
      <td>东方航空 MU2211</td>
      <td>经停</td>
      <td>08:45-13:25</td>
    </tr>
    <tr>
      <td>5068</td>
      <td>南京</td>
      <td>成都</td>
      <td>1922.0</td>
      <td>552.0</td>
      <td>南京-成都3天2晚 | 入住成都伊丽特酒店 + 东方航空/西藏航空往返机票</td>
      <td>成都伊丽特酒店 高档型 4.5分/5分</td>
      <td>行政标准间-含早立即确... 双床 双早 1间2晚</td>
      <td>东方航空 MU2880</td>
      <td>直飞</td>
      <td>21:55-00:35</td>
      <td>西藏航空 TV9839</td>
      <td>直飞</td>
      <td>06:30-08:55</td>
    </tr>
    <tr>
      <td>5081</td>
      <td>上海</td>
      <td>青岛</td>
      <td>769.0</td>
      <td>354.0</td>
      <td>上海-青岛3天2晚 | 入住青岛金中太大酒店 + 春秋航空/吉祥航空往返机票</td>
      <td>青岛金中太大酒店 舒适型 4.8分/5分</td>
      <td>特惠大床房[无早] 大床 不含早 1间2晚</td>
      <td>春秋航空 9C8853</td>
      <td>直飞</td>
      <td>19:50-21:35</td>
      <td>吉祥航空 HO1242</td>
      <td>直飞</td>
      <td>23:05-00:35</td>
    </tr>
    <tr>
      <td>5095</td>
      <td>宁波</td>
      <td>九寨沟</td>
      <td>2085.0</td>
      <td>562.0</td>
      <td>宁波-九寨沟3天2晚 | 入住黑水县达古冰山国际大酒店 + 成都航空/四川航空往...</td>
      <td>黑水县达古冰山国际大酒店 豪华型 3.9分/5分</td>
      <td>B区豪华标间(双床) 双床 不含早 1间2晚</td>
      <td>成都航空 EU2730</td>
      <td>经停</td>
      <td>19:45-00:45</td>
      <td>四川航空 3U8927</td>
      <td>经停</td>
      <td>07:55-12:15</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 13 columns</p>
</div>




```python
df.drop_duplicates(inplace=True) #删除重复
```


```python
df.duplicated().sum()
```




    0




```python
df.shape
```




    (5000, 13)




```python
df.index #删除重复值后索引出问题了
```




    Int64Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,
                ...
                5089, 5090, 5091, 5092, 5093, 5094, 5096, 5097, 5098, 5099],
               dtype='int64', length=5000)




```python
df.shape[0]
```




    5000




```python
df.index = range(df.shape[0]) #重置索引
```


```python
df.index
```




    RangeIndex(start=0, stop=5000, step=1)



### 异常值的处理
```
主要处理"价格"和"节省" 两个字段
我们进行异常值的处理的时候，不要按照我所讲的思路来。 要严格遵循未来你所处的业务场景
```


```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>价格</th>
      <th>节省</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4972.000000</td>
      <td>4983.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1767.782381</td>
      <td>474.490869</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2604.329780</td>
      <td>169.148391</td>
    </tr>
    <tr>
      <th>min</th>
      <td>578.000000</td>
      <td>306.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1253.000000</td>
      <td>358.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1633.000000</td>
      <td>436.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2031.000000</td>
      <td>532.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>179500.000000</td>
      <td>3500.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>价格</th>
      <td>4972.0</td>
      <td>1767.782381</td>
      <td>2604.329780</td>
      <td>578.0</td>
      <td>1253.0</td>
      <td>1633.0</td>
      <td>2031.0</td>
      <td>179500.0</td>
    </tr>
    <tr>
      <th>节省</th>
      <td>4983.0</td>
      <td>474.490869</td>
      <td>169.148391</td>
      <td>306.0</td>
      <td>358.0</td>
      <td>436.0</td>
      <td>532.0</td>
      <td>3500.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df["价格"].std()
```




    2604.329780079144




```python
# df["价格"]-df["价格"].mean()
```


```python
# 标准差标准化处理。 也叫做标准分数
sta = (df["价格"]-df["价格"].mean())/df["价格"].std()
```


```python
df[sta.abs()>3]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2763</th>
      <td>杭州</td>
      <td>九寨沟</td>
      <td>179500.0</td>
      <td>538.0</td>
      <td>杭州-九寨沟3天2晚 | 入住九寨沟九乡宾馆 + 成都航空/长龙航空往返机票</td>
      <td>九寨沟九乡宾馆 舒适型 4.3分/5分</td>
      <td>特惠房(双床) 双床 不含早 1间2晚</td>
      <td>成都航空 EU2206</td>
      <td>经停</td>
      <td>20:30-01:00</td>
      <td>长龙航空 GJ8680</td>
      <td>经停</td>
      <td>20:25-00:50</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[df.节省 > df.价格]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2904</th>
      <td>武汉</td>
      <td>西安</td>
      <td>949.0</td>
      <td>3500.0</td>
      <td>武汉-西安3天2晚 | 入住西安西稍门大酒店 + 东方航空往返机票</td>
      <td>西安西稍门大酒店 舒适型 3.3分/5分</td>
      <td>标准间B(丝路之旅)(... 双床 不含早 1间2晚</td>
      <td>东方航空 MU2194</td>
      <td>直飞</td>
      <td>21:50-23:30</td>
      <td>东方航空 MU2462</td>
      <td>直飞</td>
      <td>19:35-21:20</td>
    </tr>
    <tr>
      <th>3108</th>
      <td>济南</td>
      <td>大连</td>
      <td>911.0</td>
      <td>3180.0</td>
      <td>济南-大连3天2晚 | 入住普兰店科洋大酒店 + 山东航空/厦门航空往返机票</td>
      <td>普兰店科洋大酒店 舒适型 4.4分/5分</td>
      <td>大床房(限量促销) 大床 不含早 1间2晚</td>
      <td>山东航空 SC4916</td>
      <td>直飞</td>
      <td>19:45-20:50</td>
      <td>厦门航空 MF8042</td>
      <td>直飞</td>
      <td>13:10-14:20</td>
    </tr>
    <tr>
      <th>3660</th>
      <td>沈阳</td>
      <td>青岛</td>
      <td>924.0</td>
      <td>3200.0</td>
      <td>沈阳-青岛3天2晚 | 入住星程酒店青岛台东步行街店 + 青岛航/南方航空往返机票</td>
      <td>星程酒店青岛台东步行街店 舒适型 4.2分/5分</td>
      <td>大床房(内宾)(提前1... 大床 不含早 1间2晚</td>
      <td>青岛航 QW9780</td>
      <td>直飞</td>
      <td>22:35-00:10</td>
      <td>南方航空 CZ6568</td>
      <td>直飞</td>
      <td>20:55-22:35</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.concat([df[df.节省>df.价格], df[sta.abs()>3]])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2904</th>
      <td>武汉</td>
      <td>西安</td>
      <td>949.0</td>
      <td>3500.0</td>
      <td>武汉-西安3天2晚 | 入住西安西稍门大酒店 + 东方航空往返机票</td>
      <td>西安西稍门大酒店 舒适型 3.3分/5分</td>
      <td>标准间B(丝路之旅)(... 双床 不含早 1间2晚</td>
      <td>东方航空 MU2194</td>
      <td>直飞</td>
      <td>21:50-23:30</td>
      <td>东方航空 MU2462</td>
      <td>直飞</td>
      <td>19:35-21:20</td>
    </tr>
    <tr>
      <th>3108</th>
      <td>济南</td>
      <td>大连</td>
      <td>911.0</td>
      <td>3180.0</td>
      <td>济南-大连3天2晚 | 入住普兰店科洋大酒店 + 山东航空/厦门航空往返机票</td>
      <td>普兰店科洋大酒店 舒适型 4.4分/5分</td>
      <td>大床房(限量促销) 大床 不含早 1间2晚</td>
      <td>山东航空 SC4916</td>
      <td>直飞</td>
      <td>19:45-20:50</td>
      <td>厦门航空 MF8042</td>
      <td>直飞</td>
      <td>13:10-14:20</td>
    </tr>
    <tr>
      <th>3660</th>
      <td>沈阳</td>
      <td>青岛</td>
      <td>924.0</td>
      <td>3200.0</td>
      <td>沈阳-青岛3天2晚 | 入住星程酒店青岛台东步行街店 + 青岛航/南方航空往返机票</td>
      <td>星程酒店青岛台东步行街店 舒适型 4.2分/5分</td>
      <td>大床房(内宾)(提前1... 大床 不含早 1间2晚</td>
      <td>青岛航 QW9780</td>
      <td>直飞</td>
      <td>22:35-00:10</td>
      <td>南方航空 CZ6568</td>
      <td>直飞</td>
      <td>20:55-22:35</td>
    </tr>
    <tr>
      <th>2763</th>
      <td>杭州</td>
      <td>九寨沟</td>
      <td>179500.0</td>
      <td>538.0</td>
      <td>杭州-九寨沟3天2晚 | 入住九寨沟九乡宾馆 + 成都航空/长龙航空往返机票</td>
      <td>九寨沟九乡宾馆 舒适型 4.3分/5分</td>
      <td>特惠房(双床) 双床 不含早 1间2晚</td>
      <td>成都航空 EU2206</td>
      <td>经停</td>
      <td>20:30-01:00</td>
      <td>长龙航空 GJ8680</td>
      <td>经停</td>
      <td>20:25-00:50</td>
    </tr>
  </tbody>
</table>
</div>




```python
del_index = pd.concat([df[df.节省>df.价格], df[sta.abs()>3]]).index
del_index
```




    Int64Index([2904, 3108, 3660, 2763], dtype='int64')




```python
df.drop(del_index,inplace=True)
```


```python
df.shape
```




    (4996, 13)



### 缺失值的处理
- df.isnull()  查看缺失值
- df.notnull()  查看不是缺失值的
- df.dropnd()   删除缺失值
- df.fillna()  填补缺失值


```python
df.isnull().sum()
```




    出发地      2
    目的地      1
    价格      28
    节省      17
    路线名      0
    酒店       0
    房间       0
    去程航司     0
    去程方式     0
    去程时间     0
    回程航司     0
    回程方式     0
    回程时间     0
    dtype: int64




```python
df[df.出发地.isnull()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1850</th>
      <td>NaN</td>
      <td>烟台</td>
      <td>647.0</td>
      <td>348.0</td>
      <td>大连-烟台3天2晚 | 入住烟台海阳黄金海岸大酒店 + 幸福航空/天津航空往返机票</td>
      <td>烟台海阳黄金海岸大酒店 3.7分/5分</td>
      <td>海景标准间(内宾)[双... 双床 双早 1间2晚</td>
      <td>幸福航空 JR1582</td>
      <td>直飞</td>
      <td>10:05-11:05</td>
      <td>天津航空 GS6402</td>
      <td>直飞</td>
      <td>16:30-17:25</td>
    </tr>
    <tr>
      <th>1915</th>
      <td>NaN</td>
      <td>西安</td>
      <td>1030.0</td>
      <td>326.0</td>
      <td>济南-西安3天2晚 | 入住西安丝路秦国际青年旅舍钟楼回民街店 + 华夏航空往返...</td>
      <td>西安丝路秦国际青年旅舍钟楼回民街店 经济型 4.4分/5分</td>
      <td>标准间（独卫）-吃货天... 双床 不含早 1间2晚</td>
      <td>华夏航空 G54963</td>
      <td>直飞</td>
      <td>07:10-08:55</td>
      <td>华夏航空 G58858</td>
      <td>直飞</td>
      <td>23:10-00:55</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[df.价格.isnull()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>哈尔滨</td>
      <td>长沙</td>
      <td>NaN</td>
      <td>472.0</td>
      <td>哈尔滨-长沙3天2晚 | 入住长沙艾玛连锁酒店 + 海南航空/奥凯航空往返机票</td>
      <td>长沙艾玛连锁酒店 舒适型 3.7分/5分</td>
      <td>豪华双人间-不含早（预... 双床 不含早 1间2晚</td>
      <td>海南航空 HU7726</td>
      <td>经停</td>
      <td>16:25-22:05</td>
      <td>奥凯航空 BK2849</td>
      <td>经停</td>
      <td>07:15-12:50</td>
    </tr>
    <tr>
      <th>31</th>
      <td>天津</td>
      <td>西宁</td>
      <td>NaN</td>
      <td>396.0</td>
      <td>天津-西宁3天2晚 | 入住西宁运通商务宾馆 + 中国国航往返机票</td>
      <td>西宁运通商务宾馆 舒适型 4.4分/5分</td>
      <td>标准间(双床)(内宾) 双床 不含早 1间2晚</td>
      <td>中国国航 CA1241</td>
      <td>直飞</td>
      <td>15:25-17:55</td>
      <td>中国国航 CA8280</td>
      <td>经停</td>
      <td>18:15-22:05</td>
    </tr>
    <tr>
      <th>41</th>
      <td>南京</td>
      <td>青岛</td>
      <td>NaN</td>
      <td>326.0</td>
      <td>南京-青岛3天2晚 | 入住宜必思酒店青岛城阳正阳路店 + 青岛航/首都航空往返...</td>
      <td>宜必思酒店青岛城阳正阳路店 4.4分/5分</td>
      <td>大床房(酒店★力推)(... 大床 不含早 1间2晚</td>
      <td>青岛航 QW9860</td>
      <td>直飞</td>
      <td>22:55-00:10</td>
      <td>首都航空 JD5298</td>
      <td>直飞</td>
      <td>10:40-12:00</td>
    </tr>
    <tr>
      <th>51</th>
      <td>青岛</td>
      <td>长沙</td>
      <td>NaN</td>
      <td>454.0</td>
      <td>青岛-长沙3天2晚 | 入住长沙天洋大酒店 + 青岛航/幸福航空往返机票</td>
      <td>长沙天洋大酒店 3.9分/5分</td>
      <td>标准大床房[无早] 大床 不含早 1间2晚</td>
      <td>青岛航 QW9775</td>
      <td>直飞</td>
      <td>06:20-08:40</td>
      <td>幸福航空 JR2769</td>
      <td>直飞</td>
      <td>06:40-09:05</td>
    </tr>
    <tr>
      <th>73</th>
      <td>深圳</td>
      <td>呼和浩特</td>
      <td>NaN</td>
      <td>606.0</td>
      <td>深圳-呼和浩特3天2晚 | 入住呼和浩特凯基国际商务酒店 + 东方航空/深圳航空...</td>
      <td>呼和浩特凯基国际商务酒店 高档型 4.4分/5分</td>
      <td>豪华双人间 双床 双床 不含早 1间2晚</td>
      <td>东方航空 MU2877</td>
      <td>经停</td>
      <td>11:05-17:00</td>
      <td>深圳航空 ZH9128</td>
      <td>经停</td>
      <td>13:55-18:40</td>
    </tr>
    <tr>
      <th>117</th>
      <td>广州</td>
      <td>西宁</td>
      <td>NaN</td>
      <td>990.0</td>
      <td>广州-西宁3天2晚 | 入住锦江之星品尚酒店西宁五四西路新华联广场店 + 南方航...</td>
      <td>锦江之星品尚酒店西宁五四西路新华联广场店 舒适型 4.1分/5分</td>
      <td>商务房B(内宾)(特惠... 大床 不含早 1间2晚</td>
      <td>南方航空 CZ3249</td>
      <td>直飞</td>
      <td>06:30-10:10</td>
      <td>南方航空 CZ3130</td>
      <td>经停</td>
      <td>13:55-18:40</td>
    </tr>
    <tr>
      <th>118</th>
      <td>成都</td>
      <td>厦门</td>
      <td>NaN</td>
      <td>530.0</td>
      <td>成都-厦门3天2晚 | 入住厦门温泉戴斯酒店 + 四川航空/山东航空往返机票</td>
      <td>厦门温泉戴斯酒店 高档型 4.3分/5分</td>
      <td>氧吧大床房（无窗)(特... 大床 双早 1间2晚</td>
      <td>四川航空 3U8869</td>
      <td>直飞</td>
      <td>08:00-10:40</td>
      <td>山东航空 SC4763</td>
      <td>经停</td>
      <td>06:15-10:15</td>
    </tr>
    <tr>
      <th>385</th>
      <td>哈尔滨</td>
      <td>西宁</td>
      <td>NaN</td>
      <td>612.0</td>
      <td>哈尔滨-西宁3天2晚 | 入住锦江之星品尚酒店西宁火车站店 + 成都航空往返机票</td>
      <td>锦江之星品尚酒店西宁火车站店 舒适型 4.8分/5分</td>
      <td>商务标准房C 其他 不含早 1间2晚</td>
      <td>成都航空 EU2282</td>
      <td>直飞</td>
      <td>19:20-23:05</td>
      <td>成都航空 EU2281</td>
      <td>直飞</td>
      <td>15:00-18:30</td>
    </tr>
    <tr>
      <th>614</th>
      <td>大连</td>
      <td>长沙</td>
      <td>NaN</td>
      <td>424.0</td>
      <td>大连-长沙3天2晚 | 入住长沙天成国际大酒店 + 奥凯航空往返机票</td>
      <td>长沙天成国际大酒店 高档型 3.8分/5分</td>
      <td>特惠双床房（小窗） 双床 双早 1间2晚</td>
      <td>奥凯航空 BK2842</td>
      <td>经停</td>
      <td>13:00-17:30</td>
      <td>奥凯航空 BK2841</td>
      <td>经停</td>
      <td>07:25-12:00</td>
    </tr>
    <tr>
      <th>807</th>
      <td>重庆</td>
      <td>鼓浪屿</td>
      <td>NaN</td>
      <td>470.0</td>
      <td>重庆-鼓浪屿3天2晚 | 入住厦门帝乐酒店 + 西藏航空/厦门航空往返机票</td>
      <td>厦门帝乐酒店 舒适型 4.1分/5分</td>
      <td>行政客房 双床 双床 双早 1间2晚</td>
      <td>西藏航空 TV9869</td>
      <td>直飞</td>
      <td>18:35-21:10</td>
      <td>厦门航空 MF8403</td>
      <td>经停</td>
      <td>06:50-10:45</td>
    </tr>
    <tr>
      <th>917</th>
      <td>重庆</td>
      <td>青岛</td>
      <td>NaN</td>
      <td>420.0</td>
      <td>重庆-青岛3天2晚 | 入住青岛宏运东都大酒店 + 华夏航空/四川航空往返机票</td>
      <td>青岛宏运东都大酒店 4.5分/5分</td>
      <td>特惠房(无窗)(双床) 双床 不含早 1间2晚</td>
      <td>华夏航空 G54710</td>
      <td>经停</td>
      <td>18:00-22:25</td>
      <td>四川航空 3U8232</td>
      <td>直飞</td>
      <td>23:10-01:55</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>西安</td>
      <td>天津</td>
      <td>NaN</td>
      <td>350.0</td>
      <td>西安-天津3天2晚 | 入住天津中心Today酒店式公寓 + 奥凯航空往返机票</td>
      <td>天津中心Today酒店式公寓 舒适型 4.5分/5分</td>
      <td>精品大床房(预付) 大床 不含早 1间2晚</td>
      <td>奥凯航空 BK2883</td>
      <td>直飞</td>
      <td>06:20-08:25</td>
      <td>奥凯航空 BK2884</td>
      <td>直飞</td>
      <td>22:30-00:40</td>
    </tr>
    <tr>
      <th>1357</th>
      <td>天津</td>
      <td>桂林</td>
      <td>NaN</td>
      <td>474.0</td>
      <td>天津-桂林3天2晚 | 入住龙胜神龙客栈 + 奥凯航空往返机票</td>
      <td>龙胜神龙客栈 经济型 0.0分/5分</td>
      <td>标准间-不含早（预付） 双床 不含早 1间2晚</td>
      <td>奥凯航空 BK2917</td>
      <td>直飞</td>
      <td>10:30-13:20</td>
      <td>奥凯航空 BK2820</td>
      <td>直飞</td>
      <td>11:35-14:30</td>
    </tr>
    <tr>
      <th>1463</th>
      <td>上海</td>
      <td>丽江</td>
      <td>NaN</td>
      <td>570.0</td>
      <td>上海-丽江3天2晚 | 入住丽江古城柳暗花明客栈 + 首都航空/东方航空往返机票</td>
      <td>丽江古城柳暗花明客栈 经济型 4.8分/5分</td>
      <td>百花筑（标准间)-不含... 双床 不含早 1间2晚</td>
      <td>首都航空 JD5666</td>
      <td>直飞</td>
      <td>20:10-23:55</td>
      <td>东方航空 MU5820</td>
      <td>直飞</td>
      <td>09:00-12:30</td>
    </tr>
    <tr>
      <th>1579</th>
      <td>大连</td>
      <td>厦门</td>
      <td>NaN</td>
      <td>746.0</td>
      <td>大连-厦门3天2晚 | 入住厦门北站站前客栈 + 山东航空往返机票</td>
      <td>厦门北站站前客栈 经济型 4.8分/5分</td>
      <td>清新大床房-预付--北... 大床 不含早 1间2晚</td>
      <td>山东航空 SC8796</td>
      <td>经停</td>
      <td>12:30-17:35</td>
      <td>山东航空 SC8795</td>
      <td>经停</td>
      <td>07:20-11:45</td>
    </tr>
    <tr>
      <th>1786</th>
      <td>武汉</td>
      <td>重庆</td>
      <td>NaN</td>
      <td>336.0</td>
      <td>武汉-重庆3天2晚 | 入住重庆市外贸宾馆 + 华夏航空/东方航空往返机票</td>
      <td>重庆市外贸宾馆 舒适型 4.4分/5分</td>
      <td>经济房(内宾)(大床) 大床 双早 1间2晚</td>
      <td>华夏航空 G52910</td>
      <td>经停</td>
      <td>17:55-00:25</td>
      <td>东方航空 MU2540</td>
      <td>直飞</td>
      <td>23:10-00:35</td>
    </tr>
    <tr>
      <th>2099</th>
      <td>哈尔滨</td>
      <td>青岛</td>
      <td>NaN</td>
      <td>364.0</td>
      <td>哈尔滨-青岛3天2晚 | 入住青岛影都海岸海景度假公寓万达东方影都店 + 青岛航...</td>
      <td>青岛影都海岸海景度假公寓万达东方影都店 舒适型 0.0分/5分</td>
      <td>影都园景大床房 大床 不含早 1间2晚</td>
      <td>青岛航 QW9784</td>
      <td>直飞</td>
      <td>22:45-00:50</td>
      <td>福州 FU6658</td>
      <td>直飞</td>
      <td>22:20-00:20</td>
    </tr>
    <tr>
      <th>2318</th>
      <td>杭州</td>
      <td>北海</td>
      <td>NaN</td>
      <td>794.0</td>
      <td>杭州-北海3天2晚 | 入住北海石林大酒店 + 南方航空往返机票</td>
      <td>北海石林大酒店 4.0分/5分</td>
      <td>标准间（低楼层）(双床) 双床 双早 1间2晚</td>
      <td>南方航空 CZ3266</td>
      <td>经停</td>
      <td>13:55-18:15</td>
      <td>南方航空 CZ3265</td>
      <td>经停</td>
      <td>08:35-12:40</td>
    </tr>
    <tr>
      <th>3054</th>
      <td>济南</td>
      <td>沈阳</td>
      <td>NaN</td>
      <td>334.0</td>
      <td>济南-沈阳3天2晚 | 入住沈阳途家盛捷鑫汇国际服务公寓 + 首都航空/山东航空...</td>
      <td>沈阳途家盛捷鑫汇国际服务公寓 舒适型 4.6分/5分</td>
      <td>高级舒适双床房(清凉一... 双床 不含早 1间2晚</td>
      <td>首都航空 JD5348</td>
      <td>直飞</td>
      <td>16:00-17:35</td>
      <td>山东航空 SC1162</td>
      <td>直飞</td>
      <td>18:20-20:05</td>
    </tr>
    <tr>
      <th>3200</th>
      <td>厦门</td>
      <td>营口</td>
      <td>NaN</td>
      <td>602.0</td>
      <td>厦门-营口3天2晚 | 入住营口新红运酒店 + 海南航空往返机票</td>
      <td>营口新红运酒店 高档型 4.2分/5分</td>
      <td>主题房（无窗）(大床) 大床 双早 1间2晚</td>
      <td>海南航空 HU7047</td>
      <td>直飞</td>
      <td>09:55-13:20</td>
      <td>海南航空 HU7048</td>
      <td>直飞</td>
      <td>14:15-17:45</td>
    </tr>
    <tr>
      <th>3269</th>
      <td>宁波</td>
      <td>青岛</td>
      <td>NaN</td>
      <td>372.0</td>
      <td>宁波-青岛3天2晚 | 入住青岛盛泰德大酒店 + 山东航空往返机票</td>
      <td>青岛盛泰德大酒店 舒适型 4.3分/5分</td>
      <td>经济大床房(无窗)-即... 大床 不含早 1间2晚</td>
      <td>山东航空 SC4884</td>
      <td>直飞</td>
      <td>22:25-00:05</td>
      <td>山东航空 SC4883</td>
      <td>直飞</td>
      <td>07:35-09:25</td>
    </tr>
    <tr>
      <th>3421</th>
      <td>南京</td>
      <td>成都</td>
      <td>NaN</td>
      <td>554.0</td>
      <td>南京-成都3天2晚 | 入住崇州拉菲飞龙酒店 + 东方航空/西藏航空往返机票</td>
      <td>崇州拉菲飞龙酒店 舒适型 4.5分/5分</td>
      <td>B栋安静大床房（无电梯... 大床 双早 1间2晚</td>
      <td>东方航空 MU2880</td>
      <td>直飞</td>
      <td>21:55-00:35</td>
      <td>西藏航空 TV9839</td>
      <td>直飞</td>
      <td>06:30-08:55</td>
    </tr>
    <tr>
      <th>3557</th>
      <td>天津</td>
      <td>长沙</td>
      <td>NaN</td>
      <td>366.0</td>
      <td>天津-长沙3天2晚 | 入住长沙翔云君泰大酒店 + 南方航空/奥凯航空往返机票</td>
      <td>长沙翔云君泰大酒店 舒适型 4.5分/5分</td>
      <td>豪华双间(预付)(双床) 双床 不含早 1间2晚</td>
      <td>南方航空 CZ3126</td>
      <td>直飞</td>
      <td>22:55-01:20</td>
      <td>奥凯航空 BK2932</td>
      <td>直飞</td>
      <td>22:25-00:40</td>
    </tr>
    <tr>
      <th>3664</th>
      <td>沈阳</td>
      <td>九寨沟</td>
      <td>NaN</td>
      <td>474.0</td>
      <td>沈阳-九寨沟3天2晚 | 入住九顶山国际大酒店 + 西藏航空/成都航空往返机票</td>
      <td>九顶山国际大酒店 高档型 3.9分/5分</td>
      <td>特惠房[双早](双床) 双床 双早 1间2晚</td>
      <td>西藏航空 TV9880</td>
      <td>直飞</td>
      <td>21:10-00:55</td>
      <td>成都航空 EU2765</td>
      <td>经停</td>
      <td>13:35-19:10</td>
    </tr>
    <tr>
      <th>3728</th>
      <td>宁波</td>
      <td>大连</td>
      <td>NaN</td>
      <td>380.0</td>
      <td>宁波-大连3天2晚 | 入住大连橡树公馆 + 南方航空/海南航空往返机票</td>
      <td>大连橡树公馆 高档型 4.8分/5分</td>
      <td>温馨客房(限量抢购)(... 大床 不含早 1间2晚</td>
      <td>南方航空 CZ6326</td>
      <td>直飞</td>
      <td>17:55-20:05</td>
      <td>海南航空 HU7718</td>
      <td>直飞</td>
      <td>07:00-09:00</td>
    </tr>
    <tr>
      <th>3780</th>
      <td>成都</td>
      <td>杭州</td>
      <td>NaN</td>
      <td>472.0</td>
      <td>成都-杭州3天2晚 | 入住千岛湖外高桥大酒店 + 长龙航空/厦门航空往返机票</td>
      <td>千岛湖外高桥大酒店 4.1分/5分</td>
      <td>标准房(预付)(双床) 双床 双早 1间2晚</td>
      <td>长龙航空 GJ8680</td>
      <td>经停</td>
      <td>20:25-00:50</td>
      <td>厦门航空 MF8423</td>
      <td>直飞</td>
      <td>08:10-11:05</td>
    </tr>
    <tr>
      <th>3848</th>
      <td>重庆</td>
      <td>西安</td>
      <td>NaN</td>
      <td>334.0</td>
      <td>重庆-西安3天2晚 | 入住西安秦皇客栈 + 首都航空/西部航空往返机票</td>
      <td>西安秦皇客栈 经济型 4.5分/5分</td>
      <td>大床房 大床 不含早 1间2晚</td>
      <td>首都航空 JD5102</td>
      <td>直飞</td>
      <td>10:45-12:05</td>
      <td>西部航空 PN6222</td>
      <td>直飞</td>
      <td>23:50-01:20</td>
    </tr>
    <tr>
      <th>3895</th>
      <td>青岛</td>
      <td>西安</td>
      <td>NaN</td>
      <td>334.0</td>
      <td>青岛-西安3天2晚 | 入住西安申鹏国际商务酒店东大街机场大巴店 + 首都航空/...</td>
      <td>西安申鹏国际商务酒店东大街机场大巴店 4.0分/5分</td>
      <td>经济标准间(预付价格)... 双床 不含早 1间2晚</td>
      <td>首都航空 JD5756</td>
      <td>直飞</td>
      <td>22:10-00:20</td>
      <td>华夏航空 G58816</td>
      <td>直飞</td>
      <td>23:10-01:20</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc[df.出发地.isnull(),'出发地']
```




    1850    NaN
    1915    NaN
    Name: 出发地, dtype: object




```python
df.loc[df.出发地.isnull(),'路线名']
```




    1850      大连-烟台3天2晚 | 入住烟台海阳黄金海岸大酒店 + 幸福航空/天津航空往返机票
    1915    济南-西安3天2晚 | 入住西安丝路秦国际青年旅舍钟楼回民街店 + 华夏航空往返...
    Name: 路线名, dtype: object




```python
df.loc[df.出发地.isnull(),'出发地'] = [str(x)[:2] for x in df.loc[df.出发地.isnull(),'路线名']]
```


```python
df[df.出发地.isnull()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>




```python
df.出发地.isnull().sum()
```




    0




```python
df[df.目的地.isnull()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1860</th>
      <td>深圳</td>
      <td>NaN</td>
      <td>2149.0</td>
      <td>494.0</td>
      <td>深圳-大连3天2晚 | 入住大连黄金山大酒店 + 南方航空/东海往返机票</td>
      <td>大连黄金山大酒店 舒适型 3.4分/5分</td>
      <td>标准间 大/双床 不含早 1间2晚</td>
      <td>南方航空 CZ6833</td>
      <td>直飞</td>
      <td>09:10-12:40</td>
      <td>东海 DZ6242</td>
      <td>经停</td>
      <td>12:40-18:00</td>
    </tr>
  </tbody>
</table>
</div>




```python
str(df.loc[df.目的地.isnull(),"路线名"].values)
```




    "['深圳-大连3天2晚 | 入住大连黄金山大酒店 + 南方航空/东海往返机票']"




```python
str(df.loc[df.目的地.isnull(),"路线名"].values)[5:7]
```




    '大连'




```python
df.loc[df.目的地.isnull(),"目的地"] = str(df.loc[df.目的地.isnull(),"路线名"].values)[5:7]
```


```python
# 处理价格
df["价格"].mean()
```




    1732.5140901771338




```python
round(df["价格"].mean(), 0)
```




    1733.0




```python
df["价格"].fillna(round(df["价格"].mean(), 0), inplace=True)
```


```python
df["节省"].fillna(round(df["节省"].mean(), 0), inplace=True)
```


```python
df.isnull().sum()
```




    出发地     0
    目的地     0
    价格      0
    节省      0
    路线名     0
    酒店      0
    房间      0
    去程航司    0
    去程方式    0
    去程时间    0
    回程航司    0
    回程方式    0
    回程时间    0
    dtype: int64




```python
# 提取酒店评分   大连黄金山大酒店 舒适型 3.4分/5分
df["酒店评分"] = df.酒店.str.extract('(\d\.\d)分/5分')
```


```python
df["酒店评分"]
```




    0       4.7
    1       4.0
    2       4.5
    3       4.6
    4       4.1
    5       4.6
    6       4.3
    7       4.3
    8       4.4
    9       4.0
    10      4.4
    11      3.7
    12      4.5
    13      3.9
    14      4.3
    15      4.5
    16      4.3
    17      4.4
    18      4.7
    19      4.2
    20      4.0
    21      3.2
    22      4.3
    23      3.8
    24      4.7
    25      4.3
    26      3.7
    27      4.2
    28      3.6
    29      4.0
           ... 
    4970    4.6
    4971    4.6
    4972    4.6
    4973    3.7
    4974    4.1
    4975    4.5
    4976    4.6
    4977    4.0
    4978    3.5
    4979    4.0
    4980    4.3
    4981    2.8
    4982    4.5
    4983    4.6
    4984    4.3
    4985    4.3
    4986    4.1
    4987    4.2
    4988    4.4
    4989    4.2
    4990    3.6
    4991    4.3
    4992    4.5
    4993    3.7
    4994    4.7
    4995    4.3
    4996    4.6
    4997    4.5
    4998    4.0
    4999    4.0
    Name: 酒店评分, Length: 4996, dtype: object




```python
df.head(20)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
      <th>酒店评分</th>
      <th>酒店等级</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>哈尔滨</td>
      <td>北海</td>
      <td>2208.0</td>
      <td>650.0</td>
      <td>哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票</td>
      <td>北海祥丰嘉年华大酒店 舒适型 4.7分/5分</td>
      <td>标准双人间(双床) 双床 不含早 1间2晚</td>
      <td>春秋航空 9C8741</td>
      <td>直飞</td>
      <td>17:10-21:50</td>
      <td>春秋航空 9C8742</td>
      <td>直飞</td>
      <td>10:20-15:05</td>
      <td>4.7</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>1</th>
      <td>成都</td>
      <td>泸沽湖</td>
      <td>1145.0</td>
      <td>376.0</td>
      <td>成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票</td>
      <td>7天酒店丽江古城中心店 经济型 4.0分/5分</td>
      <td>经济房-不含早-限时特... 其他 不含早 1间2晚</td>
      <td>成都航空 EU2237</td>
      <td>直飞</td>
      <td>19:45-21:20</td>
      <td>成都航空 EU2738</td>
      <td>直飞</td>
      <td>23:30-01:05</td>
      <td>4.0</td>
      <td>经济型</td>
    </tr>
    <tr>
      <th>2</th>
      <td>广州</td>
      <td>沈阳</td>
      <td>2702.0</td>
      <td>618.0</td>
      <td>广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票</td>
      <td>沈阳中煤宾馆 舒适型 4.5分/5分</td>
      <td>大床间(内宾) 大床 双早 1间2晚</td>
      <td>南方航空 CZ6384</td>
      <td>直飞</td>
      <td>08:05-11:45</td>
      <td>深圳航空 ZH9652</td>
      <td>经停</td>
      <td>08:20-13:05</td>
      <td>4.5</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>3</th>
      <td>上海</td>
      <td>九寨沟</td>
      <td>1954.0</td>
      <td>484.0</td>
      <td>上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票</td>
      <td>红原芸谊大酒店 舒适型 4.6分/5分</td>
      <td>豪华双床房[双早] 双床 双早 1间2晚</td>
      <td>成都航空 EU6678</td>
      <td>直飞</td>
      <td>21:55-01:15</td>
      <td>成都航空 EU6677</td>
      <td>直飞</td>
      <td>17:45-20:35</td>
      <td>4.6</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>4</th>
      <td>广州</td>
      <td>天津</td>
      <td>1608.0</td>
      <td>422.0</td>
      <td>广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票</td>
      <td>天津逸海明珠大酒店 高档型 4.1分/5分</td>
      <td>豪华双床房(预付) 双床 不含早 1间2晚</td>
      <td>奥凯航空 BK2787</td>
      <td>直飞</td>
      <td>06:55-10:00</td>
      <td>海南航空 HU7201</td>
      <td>直飞</td>
      <td>20:15-23:25</td>
      <td>4.1</td>
      <td>高档型</td>
    </tr>
    <tr>
      <th>5</th>
      <td>长春</td>
      <td>青岛</td>
      <td>1580.0</td>
      <td>390.0</td>
      <td>长春-青岛3天2晚 | 入住青岛康大豪生大酒店 + 南方航空往返机票</td>
      <td>青岛康大豪生大酒店 豪华型 4.6分/5分</td>
      <td>精选房(大床)[酒店★... 大床 不含早 1间2晚</td>
      <td>南方航空 CZ3938</td>
      <td>直飞</td>
      <td>20:00-21:55</td>
      <td>南方航空 CZ3963</td>
      <td>直飞</td>
      <td>15:40-17:30</td>
      <td>4.6</td>
      <td>豪华型</td>
    </tr>
    <tr>
      <th>6</th>
      <td>济南</td>
      <td>九寨沟</td>
      <td>1625.0</td>
      <td>396.0</td>
      <td>济南-九寨沟3天2晚 | 入住阿坝松潘松林酒店 + 中国国航/成都航空往返机票</td>
      <td>阿坝松潘松林酒店 舒适型 4.3分/5分</td>
      <td>豪华标准间(双床) 双床 不含早 1间2晚</td>
      <td>中国国航 CA4528</td>
      <td>直飞</td>
      <td>21:00-23:30</td>
      <td>成都航空 EU2719</td>
      <td>直飞</td>
      <td>06:55-09:25</td>
      <td>4.3</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>7</th>
      <td>宁波</td>
      <td>重庆</td>
      <td>1673.0</td>
      <td>404.0</td>
      <td>宁波-重庆3天2晚 | 入住重庆运通假日酒店汽博中心店 + 南方航空/四川航空往...</td>
      <td>重庆运通假日酒店汽博中心店 舒适型 4.3分/5分</td>
      <td>特惠房(大床) 大床 双早 1间2晚</td>
      <td>南方航空 CZ8116</td>
      <td>直飞</td>
      <td>17:15-19:40</td>
      <td>四川航空 3U8983</td>
      <td>直飞</td>
      <td>06:55-09:35</td>
      <td>4.3</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>8</th>
      <td>哈尔滨</td>
      <td>南京</td>
      <td>1170.0</td>
      <td>340.0</td>
      <td>哈尔滨-南京3天2晚 | 入住维也纳酒店南京南站汇景店 + 吉祥航空/厦门航空往...</td>
      <td>维也纳酒店南京南站汇景店 舒适型 4.4分/5分</td>
      <td>特惠大床房（无窗）[双... 大床 双早 1间2晚</td>
      <td>吉祥航空 HO1651</td>
      <td>直飞</td>
      <td>17:10-20:00</td>
      <td>厦门航空 MF8067</td>
      <td>直飞</td>
      <td>19:40-22:25</td>
      <td>4.4</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>9</th>
      <td>深圳</td>
      <td>厦门</td>
      <td>1311.0</td>
      <td>350.0</td>
      <td>深圳-厦门3天2晚 | 入住厦门泊旅时尚酒店会展中心店 + 海南航空往返机票</td>
      <td>厦门泊旅时尚酒店会展中心店 舒适型 4.0分/5分</td>
      <td>时尚标准双床房 双床 双早 1间2晚</td>
      <td>海南航空 HU7065</td>
      <td>直飞</td>
      <td>07:30-08:40</td>
      <td>海南航空 HU7066</td>
      <td>直飞</td>
      <td>15:30-16:40</td>
      <td>4.0</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>10</th>
      <td>厦门</td>
      <td>沈阳</td>
      <td>2231.0</td>
      <td>606.0</td>
      <td>厦门-沈阳3天2晚 | 入住沈阳东方银座国际酒店 + 深圳航空/海南航空往返机票</td>
      <td>沈阳东方银座国际酒店 高档型 4.4分/5分</td>
      <td>高级大床房(空气清新房... 大床 不含早 1间2晚</td>
      <td>深圳航空 ZH9704</td>
      <td>经停</td>
      <td>17:20-22:10</td>
      <td>海南航空 HU7048</td>
      <td>直飞</td>
      <td>14:15-17:45</td>
      <td>4.4</td>
      <td>高档型</td>
    </tr>
    <tr>
      <th>11</th>
      <td>哈尔滨</td>
      <td>长沙</td>
      <td>1733.0</td>
      <td>472.0</td>
      <td>哈尔滨-长沙3天2晚 | 入住长沙艾玛连锁酒店 + 海南航空/奥凯航空往返机票</td>
      <td>长沙艾玛连锁酒店 舒适型 3.7分/5分</td>
      <td>豪华双人间-不含早（预... 双床 不含早 1间2晚</td>
      <td>海南航空 HU7726</td>
      <td>经停</td>
      <td>16:25-22:05</td>
      <td>奥凯航空 BK2849</td>
      <td>经停</td>
      <td>07:15-12:50</td>
      <td>3.7</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>12</th>
      <td>重庆</td>
      <td>厦门</td>
      <td>1780.0</td>
      <td>486.0</td>
      <td>重庆-厦门3天2晚 | 入住宜尚酒店厦门机场高科技园店 + 西藏航空/厦门航空往...</td>
      <td>宜尚酒店厦门机场高科技园店 舒适型 4.5分/5分</td>
      <td>商务大床房 大床 双早 1间2晚</td>
      <td>西藏航空 TV9869</td>
      <td>直飞</td>
      <td>18:35-21:10</td>
      <td>厦门航空 MF8403</td>
      <td>经停</td>
      <td>06:50-10:45</td>
      <td>4.5</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>13</th>
      <td>杭州</td>
      <td>西双版纳</td>
      <td>1665.0</td>
      <td>516.0</td>
      <td>杭州-西双版纳3天2晚 | 入住西双版纳辉煌都畅大饭店 + 长龙航空/首都航空往...</td>
      <td>西双版纳辉煌都畅大饭店 3.9分/5分</td>
      <td>高级双床房[无早] 双床 不含早 1间2晚</td>
      <td>长龙航空 GJ8823</td>
      <td>经停</td>
      <td>13:55-18:55</td>
      <td>首都航空 JD5788</td>
      <td>直飞</td>
      <td>21:40-00:50</td>
      <td>3.9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>青岛</td>
      <td>长沙</td>
      <td>1784.0</td>
      <td>450.0</td>
      <td>青岛-长沙3天2晚 | 入住林之源酒店长沙井湾子店 + 青岛航/幸福航空往返机票</td>
      <td>林之源酒店长沙井湾子店 舒适型 4.3分/5分</td>
      <td>标准双人间(双床) 双床 不含早 1间2晚</td>
      <td>青岛航 QW9775</td>
      <td>直飞</td>
      <td>06:20-08:40</td>
      <td>幸福航空 JR2769</td>
      <td>直飞</td>
      <td>06:40-09:05</td>
      <td>4.3</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>15</th>
      <td>沈阳</td>
      <td>长沙</td>
      <td>1856.0</td>
      <td>494.0</td>
      <td>沈阳-长沙3天2晚 | 入住希岸酒店长沙民政学院店 + 海南航空/四川航空往返机票</td>
      <td>希岸酒店长沙民政学院店 舒适型 4.5分/5分</td>
      <td>希岸玲珑房(大床) 大床 不含早 1间2晚</td>
      <td>海南航空 HU7330</td>
      <td>经停</td>
      <td>19:10-23:40</td>
      <td>四川航空 3U8929</td>
      <td>直飞</td>
      <td>11:00-13:55</td>
      <td>4.5</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>16</th>
      <td>大连</td>
      <td>上海</td>
      <td>1003.0</td>
      <td>314.0</td>
      <td>大连-上海3天2晚 | 入住星程酒店上海松江体育中心店 + 春秋航空/吉祥航空往...</td>
      <td>星程酒店上海松江体育中心店 舒适型 4.3分/5分</td>
      <td>双床房A优惠(内宾) 双床 不含早 1间2晚</td>
      <td>春秋航空 9C8978</td>
      <td>直飞</td>
      <td>16:05-17:55</td>
      <td>吉祥航空 HO1161</td>
      <td>直飞</td>
      <td>07:20-09:30</td>
      <td>4.3</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>17</th>
      <td>广州</td>
      <td>张家界</td>
      <td>2062.0</td>
      <td>608.0</td>
      <td>广州-张家界3天2晚 | 入住张家界富蓝特主题酒店 + 南方航空往返机票</td>
      <td>张家界富蓝特主题酒店 舒适型 4.4分/5分</td>
      <td>标准双人间(超值抢)(... 双床 不含早 1间2晚</td>
      <td>南方航空 CZ3227</td>
      <td>直飞</td>
      <td>11:40-13:20</td>
      <td>南方航空 CZ3228</td>
      <td>直飞</td>
      <td>20:00-21:40</td>
      <td>4.4</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>18</th>
      <td>西安</td>
      <td>呼和浩特</td>
      <td>1040.0</td>
      <td>330.0</td>
      <td>西安-呼和浩特3天2晚 | 入住呼和浩特包钢海德酒店 + 瑞丽航空/天津航空往返...</td>
      <td>呼和浩特包钢海德酒店 高档型 4.7分/5分</td>
      <td>高级标间(双床) 双床 不含早 1间2晚</td>
      <td>瑞丽航空 DR5319</td>
      <td>直飞</td>
      <td>09:45-11:30</td>
      <td>天津航空 GS7656</td>
      <td>直飞</td>
      <td>23:05-00:50</td>
      <td>4.7</td>
      <td>高档型</td>
    </tr>
    <tr>
      <th>19</th>
      <td>哈尔滨</td>
      <td>长沙</td>
      <td>1791.0</td>
      <td>470.0</td>
      <td>哈尔滨-长沙3天2晚 | 入住长沙佳华酒店 + 海南航空/奥凯航空往返机票</td>
      <td>长沙佳华酒店 舒适型 4.2分/5分</td>
      <td>标准大床房(提前3小时... 大床 不含早 1间2晚</td>
      <td>海南航空 HU7726</td>
      <td>经停</td>
      <td>16:25-22:05</td>
      <td>奥凯航空 BK2849</td>
      <td>经停</td>
      <td>07:15-12:50</td>
      <td>4.2</td>
      <td>舒适型</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 提取酒店等级   天津逸海明珠大酒店 高档型 4.1分/5分
df["酒店等级"] = df.酒店.str.extract(" (.+ )")
```


```python
df["酒店等级"]
```




    0       舒适型 
    1       经济型 
    2       舒适型 
    3       舒适型 
    4       高档型 
    5       豪华型 
    6       舒适型 
    7       舒适型 
    8       舒适型 
    9       舒适型 
    10      高档型 
    11      舒适型 
    12      舒适型 
    13       NaN
    14      舒适型 
    15      舒适型 
    16      舒适型 
    17      舒适型 
    18      高档型 
    19      舒适型 
    20      舒适型 
    21       NaN
    22      豪华型 
    23      舒适型 
    24      高档型 
    25       NaN
    26      舒适型 
    27      高档型 
    28      舒适型 
    29       NaN
            ... 
    4970    舒适型 
    4971    舒适型 
    4972    舒适型 
    4973    舒适型 
    4974    舒适型 
    4975    舒适型 
    4976     NaN
    4977    舒适型 
    4978    舒适型 
    4979    舒适型 
    4980    舒适型 
    4981    高档型 
    4982     NaN
    4983    高档型 
    4984    舒适型 
    4985    高档型 
    4986    高档型 
    4987    高档型 
    4988    高档型 
    4989    舒适型 
    4990    舒适型 
    4991    高档型 
    4992    舒适型 
    4993     NaN
    4994    高档型 
    4995    豪华型 
    4996    经济型 
    4997    经济型 
    4998    舒适型 
    4999    舒适型 
    Name: 酒店等级, Length: 4996, dtype: object




```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
      <th>酒店评分</th>
      <th>酒店等级</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>哈尔滨</td>
      <td>北海</td>
      <td>2208.0</td>
      <td>650.0</td>
      <td>哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票</td>
      <td>北海祥丰嘉年华大酒店 舒适型 4.7分/5分</td>
      <td>标准双人间(双床) 双床 不含早 1间2晚</td>
      <td>春秋航空 9C8741</td>
      <td>直飞</td>
      <td>17:10-21:50</td>
      <td>春秋航空 9C8742</td>
      <td>直飞</td>
      <td>10:20-15:05</td>
      <td>4.7</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>1</th>
      <td>成都</td>
      <td>泸沽湖</td>
      <td>1145.0</td>
      <td>376.0</td>
      <td>成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票</td>
      <td>7天酒店丽江古城中心店 经济型 4.0分/5分</td>
      <td>经济房-不含早-限时特... 其他 不含早 1间2晚</td>
      <td>成都航空 EU2237</td>
      <td>直飞</td>
      <td>19:45-21:20</td>
      <td>成都航空 EU2738</td>
      <td>直飞</td>
      <td>23:30-01:05</td>
      <td>4.0</td>
      <td>经济型</td>
    </tr>
    <tr>
      <th>2</th>
      <td>广州</td>
      <td>沈阳</td>
      <td>2702.0</td>
      <td>618.0</td>
      <td>广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票</td>
      <td>沈阳中煤宾馆 舒适型 4.5分/5分</td>
      <td>大床间(内宾) 大床 双早 1间2晚</td>
      <td>南方航空 CZ6384</td>
      <td>直飞</td>
      <td>08:05-11:45</td>
      <td>深圳航空 ZH9652</td>
      <td>经停</td>
      <td>08:20-13:05</td>
      <td>4.5</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>3</th>
      <td>上海</td>
      <td>九寨沟</td>
      <td>1954.0</td>
      <td>484.0</td>
      <td>上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票</td>
      <td>红原芸谊大酒店 舒适型 4.6分/5分</td>
      <td>豪华双床房[双早] 双床 双早 1间2晚</td>
      <td>成都航空 EU6678</td>
      <td>直飞</td>
      <td>21:55-01:15</td>
      <td>成都航空 EU6677</td>
      <td>直飞</td>
      <td>17:45-20:35</td>
      <td>4.6</td>
      <td>舒适型</td>
    </tr>
    <tr>
      <th>4</th>
      <td>广州</td>
      <td>天津</td>
      <td>1608.0</td>
      <td>422.0</td>
      <td>广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票</td>
      <td>天津逸海明珠大酒店 高档型 4.1分/5分</td>
      <td>豪华双床房(预付) 双床 不含早 1间2晚</td>
      <td>奥凯航空 BK2787</td>
      <td>直飞</td>
      <td>06:55-10:00</td>
      <td>海南航空 HU7201</td>
      <td>直飞</td>
      <td>20:15-23:25</td>
      <td>4.1</td>
      <td>高档型</td>
    </tr>
  </tbody>
</table>
</div>




```python
df["天数"] = df.路线名.str.extract('(\d+)天\d晚')
```


```python
df["天数"]
```




    0       3
    1       3
    2       3
    3       3
    4       3
    5       3
    6       3
    7       3
    8       3
    9       3
    10      3
    11      3
    12      3
    13      3
    14      3
    15      3
    16      3
    17      3
    18      3
    19      3
    20      3
    21      3
    22      3
    23      3
    24      3
    25      3
    26      3
    27      3
    28      3
    29      3
           ..
    4970    3
    4971    3
    4972    3
    4973    3
    4974    3
    4975    3
    4976    3
    4977    3
    4978    3
    4979    3
    4980    3
    4981    3
    4982    3
    4983    3
    4984    3
    4985    3
    4986    3
    4987    3
    4988    3
    4989    3
    4990    3
    4991    3
    4992    3
    4993    3
    4994    3
    4995    3
    4996    3
    4997    3
    4998    3
    4999    3
    Name: 天数, Length: 4996, dtype: object




```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
      <th>酒店评分</th>
      <th>酒店等级</th>
      <th>天数</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>哈尔滨</td>
      <td>北海</td>
      <td>2208.0</td>
      <td>650.0</td>
      <td>哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票</td>
      <td>北海祥丰嘉年华大酒店 舒适型 4.7分/5分</td>
      <td>标准双人间(双床) 双床 不含早 1间2晚</td>
      <td>春秋航空 9C8741</td>
      <td>直飞</td>
      <td>17:10-21:50</td>
      <td>春秋航空 9C8742</td>
      <td>直飞</td>
      <td>10:20-15:05</td>
      <td>4.7</td>
      <td>舒适型</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>成都</td>
      <td>泸沽湖</td>
      <td>1145.0</td>
      <td>376.0</td>
      <td>成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票</td>
      <td>7天酒店丽江古城中心店 经济型 4.0分/5分</td>
      <td>经济房-不含早-限时特... 其他 不含早 1间2晚</td>
      <td>成都航空 EU2237</td>
      <td>直飞</td>
      <td>19:45-21:20</td>
      <td>成都航空 EU2738</td>
      <td>直飞</td>
      <td>23:30-01:05</td>
      <td>4.0</td>
      <td>经济型</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>广州</td>
      <td>沈阳</td>
      <td>2702.0</td>
      <td>618.0</td>
      <td>广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票</td>
      <td>沈阳中煤宾馆 舒适型 4.5分/5分</td>
      <td>大床间(内宾) 大床 双早 1间2晚</td>
      <td>南方航空 CZ6384</td>
      <td>直飞</td>
      <td>08:05-11:45</td>
      <td>深圳航空 ZH9652</td>
      <td>经停</td>
      <td>08:20-13:05</td>
      <td>4.5</td>
      <td>舒适型</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>上海</td>
      <td>九寨沟</td>
      <td>1954.0</td>
      <td>484.0</td>
      <td>上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票</td>
      <td>红原芸谊大酒店 舒适型 4.6分/5分</td>
      <td>豪华双床房[双早] 双床 双早 1间2晚</td>
      <td>成都航空 EU6678</td>
      <td>直飞</td>
      <td>21:55-01:15</td>
      <td>成都航空 EU6677</td>
      <td>直飞</td>
      <td>17:45-20:35</td>
      <td>4.6</td>
      <td>舒适型</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>广州</td>
      <td>天津</td>
      <td>1608.0</td>
      <td>422.0</td>
      <td>广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票</td>
      <td>天津逸海明珠大酒店 高档型 4.1分/5分</td>
      <td>豪华双床房(预付) 双床 不含早 1间2晚</td>
      <td>奥凯航空 BK2787</td>
      <td>直飞</td>
      <td>06:55-10:00</td>
      <td>海南航空 HU7201</td>
      <td>直飞</td>
      <td>20:15-23:25</td>
      <td>4.1</td>
      <td>高档型</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1 = pd.DataFrame({"key":['a','b','c'],"data_set1":[1,2,3]})
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data_set1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2 = pd.DataFrame({"key":['a','b','c'],"data_set2":[4,5,6]})
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data_set2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.merge(df1,df2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data_set1</th>
      <th>data_set2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>




```python

```
